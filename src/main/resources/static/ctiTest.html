<!doctype html>

<script src="jquery-2.1.4.min.js"></script>
<script src="stomp.js"></script>
<script src="sockjs-1.0.3.js"></script>

<script>

$(document).ready(function(){

    //Instantiate adapter
    adapter = new OmniCTIAdapter({
        url: "http://localhost:8080",
        eventCallbackPath: "/messages/cti/eventcallback",
        logPath: "/messages/cti/log",
        sendEventsPath: "/gateway/cti/command/"
    });


    function sendTestData(action){
        adapter[action]({
            arguments : {
                arg1 : "teste",
                arg2 : "teste2"
            }
        })
    }


    //apply binds
    $('.login').click(function(){sendTestData("login")});
    $('.logout').click(function(){sendTestData("logout")});
    $('.xxx').click(function(){sendTestData("xxx")});
    $('.becomeAvailable').click(function(){sendTestData("becomeAvailable")});
    $('.becomeUnavailable').click(function(){sendTestData("becomeUnavailable")});
    $('.answer').click(function(){sendTestData("answer")});
    $('.dropCall').click(function(){sendTestData("dropCall")});
    $('.connect').click(function(){adapter.connect();});



    adapter.on("OmniCTIConnect", function(){
        $('#mensagem').text('Conectado!');
    });
    adapter.on("ring", function(){
        console.log(this.eventName)
        console.log(this.returnCode)
        console.log(this.returnMessage)
        console.log(this.arguments)
        $('#mensagem').text('Est√° tocando!!!');
        $('.answer').removeAttr('disabled');
    });
    adapter.on("answer", function(){
        $('#mensagem').text('Chamada em curso');
        $('.answer').attr('disabled','disabled');
        $('.dropCall').removeAttr('disabled');
    });
    adapter.on("dropCall",function(){
        $('#mensagem').text('Aguardando chamada');
        $('.answer').attr('disabled','disabled');
        $('.dropCall').attr('disabled','disabled');
    })

    adapter.on("log",function(){
        console.log(this.level)
        console.log(this.logger)
        console.log(this.message)
    })



});
</script>


<html>
<head>
    <meta charset="utf-8">
    <title>Demo</title>
</head>
<body>



<button class="connect">Conectar</button>
<br>
<button class="login">Login</button>
<button class="logout">Logout</button>
<button class="xxx">xxx</button>
<button class="becomeAvailable">Become Available</button>
<button class="becomeUnavailable">Become Unavailable</button>
<button class="answer" disabled>answer</button>
<button class="dropCall" disabled>dropCall</button>

<br>
<div id="mensagem"></div>
<BR>
<BR>
ERROS
<div id="error"></div>
<script src="OmniCTIAdapter.js"></script>
</body>
</html>